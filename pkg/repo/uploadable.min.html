<!DOCTYPE html><html lang=en><title>Upload Keys - akhttpd - Authorized Keys HTTP Daemon</title><style>body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.5;color:#000;background:#fff}a{color:#000;text-decoration:underline}code,textarea{background:#d3d3d3;padding:5px}code.key,code.replace{user-select:all}code.block{margin:10px}textarea{display:block;min-width:50%;margin:10px;border:0}</style><p>You can use this page to install an ssh key onto a server. This page is powered by <a href=/ >akhttpd</a>.<ol><li>Paste your key into the box below.<li>Click on <em>Continue</em> to make the key available.<li>Follow the instructions to download it to other machines.<li>Click on the <em>Stop</em> button or close the window to delete the key from the server.</ol><form id=form><textarea id=key rows=10>
</textarea><button>Make Available</button></form><div id=error style=display:initial></div><div id=result style=display:none><p>The key has been made available on the server temporarily. Close the window or click the <em>Stop</em> button to delete it.<p>To install this key on an ssh server, you could do something like:<p><code class="block replace">curl -L localhost:8080/{{.User}} > .ssh/authorized_keys</code><p>For convenience, this service also exposes a script to do this automatically. Using this script will overwrite any existing SSH Keys for your user. You can use it like:<p><code class="block replace">curl -L localhost:8080/{{.User}}.sh | sh</code></div><script>var registerKey=function(b,c,d,e){try{var a=new WebSocket(location.href.replace("http","ws"))}catch(g){e();return}var f=function(){a.onclose=function(){};a.onerror=function(){};a.onmessage=function(){};try{a.close()}catch(g){}};a.onerror=function(){f();e()};a.onopen=function(){a.send(b)};a.onmessage=function(g){a.onclose=function(){d();f()};a.onerror=function(){d();f()};a.onmessage=function(){};c(g.data,function(){f();d()})};a.onclose=function(){f();e()}},form=document.getElementById("form"),button=
    form.querySelector("button"),textarea=document.getElementById("key"),error=document.getElementById("error"),result=document.getElementById("result"),resetUI=function(b){console.log("resetUI",b);button.removeAttribute("disabled");button.innerHTML="Make Available";form.removeEventListener("submit",handleEnd);form.addEventListener("submit",handleBegin);textarea.removeAttribute("readonly");result.style.display="none";var c=document.createElement("p");b&&c.append(document.createTextNode(b));error.innerHTML=
    "";error.append(c);error.style.display=b?"initial":"none"},resultHTML=result.innerHTML,showUI=function(b){button.removeAttribute("disabled");button.innerHTML="Stop";form.removeEventListener("submit",handleBegin);form.addEventListener("submit",handleEnd);error.style.display="none";error.innerHTML="";result.style.display="";result.innerHTML=resultHTML;for(var c=result.querySelectorAll(".replace"),d=0;d<c.length;d++){var e=c[d],a=location.host;e.innerHTML=e.innerHTML.replace("http://localhost:8080",
    location.protocol+"//"+a).replace("localhost:8080",a).replace("{{.User}}",b)}},handleBegin,handleEnd,stopHandler;handleBegin=function(b){b.preventDefault();b=textarea.value;button.setAttribute("disabled","disabled");textarea.setAttribute("readonly","readonly");form.removeEventListener("submit",handleBegin);registerKey(b,function(c,d){stopHandler=d;showUI(c)},resetUI.bind(void 0,"Server connection has been closed. "),resetUI.bind(void 0,"Failed to make key available. Is it in the correct format?"))};
    handleEnd=function(b){b.preventDefault();resetUI();stopHandler()};resetUI();</script>